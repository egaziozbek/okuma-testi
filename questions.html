<!-- ... önceki head kısmı aynı kalır ... -->
<script type="module">
  import { initializeApp } from "https://www.gstatic.com/firebasejs/10.11.0/firebase-app.js";
  import { getFirestore, doc, getDoc } from "https://www.gstatic.com/firebasejs/10.11.0/firebase-firestore.js";

  const firebaseConfig = {
    apiKey: "AIzaSyCLp-t81vU5S1LDr76YKszeG1LcHwU0GZQ",
    authDomain: "okuma-testi.firebaseapp.com",
    projectId: "okuma-testi",
    storageBucket: "okuma-testi.firebasestorage.app",
    messagingSenderId: "820936161658",
    appId: "1:820936161658:web:0bd9c4dc043cfad0667ec3",
    measurementId: "G-2WBL96ETV1"
  };

  const app = initializeApp(firebaseConfig);
  const db = getFirestore(app);

  let dogruCevaplar = [];

  async function sorulariYukle() {
    const docRef = doc(db, "questions", "0p5ZCRA6tUvLUvIEWlNg");
    const docSnap = await getDoc(docRef);

    if (docSnap.exists()) {
      const veri = docSnap.data();
      const sorular = veri.sorular;

      let formHTML = "";

      sorular.forEach((soruObj, index) => {
        dogruCevaplar.push(soruObj.cevap);

        formHTML += `<div class="question">
          <p><strong>${index + 1}. ${soruObj.soru}</strong></p>`;

        // Boş bırak seçeneği (ilk sırada)
        formHTML += `<div class="option">
          <label><input type="radio" name="soru${index}" value=""> Boş bırak</label>
        </div>`;

        soruObj.secenekler.forEach(secenek => {
          formHTML += `<div class="option">
            <label><input type="radio" name="soru${index}" value="${secenek}"> ${secenek}</label>
          </div>`;
        });

        formHTML += `</div>`;
      });

      document.getElementById("soruForm").innerHTML = formHTML;
    } else {
      document.getElementById("soruForm").innerHTML = "<p>Sorular yüklenemedi.</p>";
    }
  }

  window.kontrolEt = function () {
    const toplamSoru = dogruCevaplar.length;
    let dogru = 0;
    let yanlis = 0;
    let eksikVar = false;

    dogruCevaplar.forEach((cevap, i) => {
      const secilen = document.querySelector(`input[name='soru${i}']:checked`);
      if (!secilen) {
        eksikVar = true;
      } else {
        const deger = secilen.value;
        if (deger === "") {
          // boş bırak seçilmişse sayma
          return;
        } else if (deger === cevap) {
          dogru++;
        } else {
          yanlis++;
        }
      }
    });

    if (eksikVar) {
      alert("Lütfen tüm sorulara cevap veriniz. Her soru için 'Boş bırak' seçeneği de vardır.");
      return;
    }

    localStorage.setItem("dogruSayisi", dogru);
    localStorage.setItem("yanlisSayisi", yanlis);
    localStorage.setItem("basariYuzdesi", ((dogru / toplamSoru) * 100).toFixed(1));

    window.location.href = "result.html";
  }

  sorulariYukle();
</script>
